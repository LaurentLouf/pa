\part{Partie informatique, électronique}

L'enjeu de cette partie est grand : il s'agit d'une part de détecter la balle, sa position ainsi que les composantes de son mouvement : vitesses de rotation et vitesses de translation. Le système devant pouvoir être utilisé pour tout type de joueurs, on peut estimer que le pire des scénarios est celui d'un jeu d'échange de grand joueur où la balle se déplace en moyenne à 100  km/h ce qui impose de fortes contraintes temporelles pour les parties acquisition et commande. D'autre part, il faut aussi commander le mur pour qu'il se trouve dans la bonne position pour renvoyer la balle où cela a été décidé par l'algorithme de jeu (non étudié ici), ce qui devra prendre en compte de la position du joueur, qu'il faudra donc déterminer.\\

En supposant que la balle est tapée en fond de court et que le mur se trouve sur le fond de court opposé, le système dispose de moins d'une seconde pour faire l'acquisition et déplacer le mur en conséquence. Mais cette hypothèse est peu probable et il y a de grandes chances pour qu'on ne détecte la balle qu'au moment de son passage au-dessus du filet. De plus, le mur se trouvera sur la ligne de service ce qui ne laisse donc au système qu'environ 200ms pour capter la balle et se déplacer en fonction. \\

C'est pour ces raisons qu'un certain nombre de solutions techniques ont du être envisagées aussi bien pour la partie détection de la balle, détection du joueur que déplacement du mur.

\chapter{Détection de la balle}


L'enjeu de cette partie est de détecter la position de la balle ainsi que les composantes de son mouvement : vitesses de translation ainsi que vitesses de rotation. 

Si les premières sont assez faciles à trouver (il suffit de détecter la balle dans deux positions assez proches), les vitesses de rotation se révèlent plus compliquées à obtenir du fait des vitesses de rotation pouvant atteindre 75 tr/s, soit une rotation toutes les 13ms. 

Si on veut détecter cette rotation, dans le cas d'une caméra, il faudrait donc pouvoir au moins acquérir deux images durant cette rotation soit une image toute les 6ms environ. Il a donc été nécessaire de faire un peu d'exploration de différentes techniques d'acquisition afin de trouver la solution la plus adaptée à notre problème.


\section{Détection de la position et de la vitesse de translation}



\subsection{Détection par laser}

\subsubsection{Rideaux de lasers}

Une première méthode pour détecter la position de la balle à différents instants serait d'utiliser des barrières de lasers comme on peut en trouver dans l'industrie pour limiter l'accès à des machines dangeureuses. On peut en voir notamment sur la figure \ref{img:rideaulasers}. \\

On a donc besoin d'autant de ces systèmes qu'on veut de positions de la balle (pour la partie calcul et détermination de la trajectoire de la balle), ce qui peut donc vite se révéler très contraignant, tant en termes de coûts que de modularité, mais aussi de positionnement et donc de délai avant impact de la balle avec le mur. En effet, un tel type de procédé peut comporter des risques pour l'utilisateur (utilisation de lasers) et ne peut donc pas pointer vers le joueur. On pourrait donc placer ces capteurs de part et d'autre du filet, mais on limite donc de fait le temps dont on dispose pour déplacer le mur. \\

De plus, il faut un espacement maximal entre deux capteurs lasers de 5cm (une balle de tennis en faisant un peu plus de 6), on a donc besoin d'un nombre de capteurs proportionnel à la hauteur maximale à laquelle on veut détecter le passage de la balle, ce qui aura donc une influence directe sur le prix. Enfin, la plupart des solutions trouvées dans l'industrie ne permettent que de détecter le franchissement (d'objets plus ou moins petits selon l'espacement entre les lasers) et non pas la position où l'objet a traversé le rideau. Il doit néanmoins être possible d'adapter ces solutions, mais cela demanderait du travail supplémentaire. 


\subsubsection{Balayage laser}

\paragraph{Balayage 2D\\}

Une autre solution serait d'utiliser un capteur basé sur un balayage laser. Le principe est quasiment similaire au précédent, c'est-à-dire qu'un balayage 2D nécessiterait d'avoir autant de capteurs qu'on veut de positions de la balle. De la même manière que précédemment, la sécurité de l'utilisateur est aussi à prendre en jeu. \\

On peut donc imaginer un système de capteurs suspendus au plafond, il faut donc prendre en compte la hauteur à laquelle se trouve le capteur pour pouvoir trouver la résolution angulaire minimale à avoir pour pouvoir détecter la balle. À 5m de hauteur, avec un seul capteur pour toute la largeur du terrain, on doit avoir une ouverture angulaire de 94$^{\circ}$, une portée maximale de 7.5m et quelques calculs de trigonométrie donnent une résolution angulaire de minimum 0.25$^{\circ}$. Cependant, à la vue des caractéristiques de différents capteurs de ce type, il ne semble pas que cela soit très contraignant \\ 

La vitesse de la balle va aussi dans ce cas imposer de fortes contraintes sur la fréquence de réalisation des scans. La balle faisant 6cm de diamètre, la taille du faisceau étant d'environ 1cm à la distance citée précédemment, il faut donc que la balle ne parcourt pas plus de 5cm entre deux scans complets, ce qui donne donc une fréquence de balayage de 560Hz. \\

L'ensemble de ces caractéristiques (portée, résolution angulaire et fréquence de scan) semble pour l'instant très dur à trouver (aucune référence chez SICK, et la meilleure référence chez Pulse-In\footnote{http://www.triple-in.de/english/products/2d-laser-scanners/pas/} ne convient pas à nos besoins). 


\paragraph{Balayage 3D\\}

Une solution pour ne pas avoir à multiplier les capteurs est d'utiliser un capteur qui fasse un balayage 3D, ce qui permet donc d'avoir plusieurs positions de la balle avec un seul capteur. Néanmoins, il semble impossible d'avoir un capteur qui puisse avoir une cadence suffisamment élevée pour réaliser ces mesures et le prix d'un tel capteur serait tout simplement beaucoup trop élevé, sachant que la meilleure référence trouvée\footnote{http://www.robotshop.com/eu/fr/capteur-3d-balayage-laser-precision.html} coûte déjà plus de 50 000\texteuro. 


\subsection{Détection par caméra}

Une solution alternative à la détection par laser est la détection par caméra. Si cette méthode pose quelques problèmes que l'on a pas avec la détection par laser, elle en résoud certain. On capte en effet une assez grande surface, on n'a donc pas besoin d'une vitesse excessivement élevée pour avoir la balle dans le champ (ce qui est par contre très problématique avec le laser). On a par contre des problèmes de flou que l'on n'avait pas avant. La détection de la balle est aussi plus problématique puisqu'il faut la distinguer du reste de l'environnement qui est visuellement très riche et bourré d'information, dont la très grande majorité est inutile dans notre cas. Bien positionnée, une caméra peut aussi servir à détecter le joueur ce qui est le sujet d'une autre partie.


\subsubsection{Type de caméra}

s

\subsubsection{Caractéristiques caméra}












\section{Détection de la vitesse de rotation}

Un des éléments qui nous paraissait essentiel pour déterminer la trajectoire et le rebond de la balle était la vitesse de rotation de celle ci. En effet il apparait comme trivial qu'une balle qui tourne sur elle même par rapport à un axe parallèle à un plan ne rebondira pas de la même manière qu'une balle sans rotation. Pour le vérifier, il suffit pour celà de se munir d'une balle (de tennis ou autre) de la faire tourner vers soi en la laissant tomber verticalement au sol et la balle va rebondir vers soi.\\

Un autre phénomène rentre en jeu avec des vitesses de rotation relativement élevées, c'est l'effet Magnus. Cet effet découle de la mécanique des fluides. Quand la balle entre en rotation elle déplace des masses d'air et crée des différences de pression autour d'elle même. Ces différences de pression engendre naturellement une pression résultante qui se comporte comme une force. Celle ci peut être verticale et donc porter la balle vers le haut, comme l'est une aile d'avion, ou au contraire vers le bas. Cette effet peut bien sûr faire dévier la balle dans les autres direction suivant les axes de rotations, et on comprend alors tous l'intéret de ces effets qui peuvent dévier la balle d'un mètre dans un sport comme le tennis.\\

La vitesse de rotation maximum qu'un joueur de haut niveau peut fournir est d'environ 100 tours par seconde, ce qui ne pouvait donc pas être mesuré simplement, mais on considére que la vitesse de rotation de la balle est constante durant son trajet durant entre 0.5s et 1s.

\subsection{Caméra ultra-rapide}

Lors de notre première approche, nous nous sommes dit : Puisque la balle tourne très vite, mesurons la à très haute vitesse aussi, ainsi on décomposera aisément son comportement et donc sa vitesse de rotation selon les 3 axes. En nous fixant 100 tours par seconde comme limite, il faudrait voir un même point de la balle passer d'une position à une autre sans passer par la face cachée de la balle entre temps. en admettant que l'on voit bien un bon tiers, voire deux cinquièmes de la balle (les bords de la moitié visible ne sont pas de très bonne qualité et pas facilement exploitable). Nous avons ensuite considéré qu'il faudrait qu'un point ne puisse parcourir que la moitié de cette zone claire pour que l'on détermine la vitesse de rotation sans trop d'ambiguité. Ce qui au final nous fait un cinquième ou un sixième de balle qui défile à 100 tours par seconde entre 2 images, soit une caméra à 500-600 fps minimum.\\

Nous avons donc effectué de nombreuses recherches de camera de ce type avec une résolution correcte. En effet soit cette camera sert à détecter la position et vitesse linéaire de la balle comme vu précédemment, soit elle vient se supplanter au système. Dans le premier cas il faut imaginer une caméra qui voit le demi terrain imaginons par dessus ; la camera devra alors être capable de couvrir 11.9m en longueur et des motifs sur la balle. Au début nous avions imaginé traiter les bandes blanches se trouvant sur la balle, faisant 2mm d'épaisseur en étant généreux. Ce qui nous fait un rapport de 5500 avec la balle au sol, c'est à dire qu'en ayant 5500 pixels de définition dans le sens de la longueur, on pouvait s'assurer d'avoir tout la longueur du demi-court et d'avoir la ligne blanche de la balle présente sur 1 pixel ... Bien sûr c'est en prenant les conditions extrêmes car la balle est rarement au sol mais en l'air ce qui la rapproche de la caméra et la grossit donc, et nous aurions put développer des marqueurs additionnels plus gros, et de couleur sûrement moins difficile à traiter que du blanc alors que le marquage des terrain est en blanc.\\

Cette solution fût vite abandonnée à cause de ce problème de résolution et des surcoûts en terme d'argent et de temps de traitement qu'elle engendrait. Néanmoins l'idée d'une caméra rapide nous semblait toujours être la meilleure solution ne nécessitant pas un matériel trop particulier de la part du tennisman (ou de la tenniswoman !). L'idée était donc de diminuer la résolution nécessaire, donc de cadrer une image moins large. Nous sommes dit qu'au dessus du terrain celà demanderait de mettre la caméra relativement basse et pouvait être dangereux, donc nous avons étudié une camera sur le coté, à la hauteur du poteau du filet. Ainsi elle ne pourrait cadrer par exemple que 3m ce qui ramenerait notre rapport à 1500 ce qui correspond environ à de la full HD, tout à fait abordable. L'inconvénient étant qu'on ne détecte la balle au dernier moment et le mur n'aura donc pas énormément de temps pour se mettre en place. Une idée naïve serait de se dire que l'on peut placer la camera plus loin dans le terrain par exemple à 6m du filet, mais si la joueur doit monter au filet on ne verra plus rien du tout, ce qui est pire que tout.\\

Finalement après moult recherches nous avions trouvé la caméra M3 de IDT qui correspondait assez bien à nos attentes à un prix contenu (15000€ tout de même), puis nous avons trouvé la Edgertronic qui nous paraissait miraculeuse pour son tarif, mais nous sommes vite rendus compte qu'elle ne proposait bizarrement pas de mode streaming, et ne pouvait fournir une vidéo que par carte SD, ce qui était plus que gênant pour notre système temps réel.\\

Mais le véritable problème de cette solution était la vitesse à laquelle il fallait traiter les images (2ms à 500fps). Nous n'avons pas réalisé d'algorithme pour cette détection de vitesse de rotation, mais il serait à mon goût plus coûteux que la detection des coordonnées x,y,z ; et déjà ce dernier nous prenait 70-75ms pour une image au début, ce qui nous a mis un gros coup de doute sur la réalisation de notre idée. Ensuite en essayant sur un ordinateur de bureau récent et puissant nous avons constaté que nous gagnions à peine 5ms par image, mais que OpenCV n'utilisait pas toutes les ressources CPU, uniquement la moitié de la puissance sur place (les 4 coeurs tournaient à 50\% d'après le moniteur système). Nous sommes donc décidés à faire passer les calculs par la carte graphique de cet ordinateur de bureau à travers le module OpenCL de OpenCV (c'est une carte AMD, le module gpu est donc incompatible car écrit en CUDA), ce qui ne fût pas sans difficultés, notamment au niveau des pilotes sous linux. Finalement après quelques jours de configuration le programme s'est mis à tourner sur GPU, et là les gains nous émerveillèrent ! Après application d'une ou 2 fonctions sur gpu le temps passa déjà vers les 50ms. Puis les optimisations diverses ainsi que le portage d'un maximum de fonctions sur GPU nous ont amené à un temps de calcul de 11.5ms par image, en prenant en compte que 3.2ms est due à l'acquisition de l'image à partir du fichier vidéo, à voir si ce temps sera beaucoup plus court avec un système de stream. Malgré notre bohneur face à cette explosion de performance, le taux de traitement ne plafonne qu'à 85Hz (en FullHD), autant vous dire qu'on est encore très loin des 500Hz avec un algorithme sûrement plus complexe. Voilà pourquoi nous avons définitivement l'idée d'une caméra ultra-rapide sur ce projet.

Malgré tout nous avions imaginé utiliser une imagerie infrarouge pour obtenir directement une image en niveau de gris, où certaines parties de la balle réfléchirait les infrarouges. Ainsi les traitement associés à cette image seraient largement réduit, au niveau du filtrage et de la suppression du bruit. Pour celà nous avions imaginé avoir un éclairage infrarouge qui illumine le demi-court de tennis ou est le joueur, et que la balle possède des parties réfléchissante qui ressortiront très clairement sur les images. Pour celà nous avions pensé à coller des bandes réfléchissante sur la balle. Cependant cette solution apparait comme plus que limité car on modifie la surface de rebond de la balle donc sa réaction au sol, et la bande risque de se décoller à tout moment en raison des chocs qui sont appliqués sur cette zone. Nous avions donc imaginé ensuite d'appliquer quelque chose qui réfléchissent les infrarouge et qui adhère fortement à la balle. La zone qui nous paraissait encore la plus propice était la bande blanche parcourant la balle de tennis, car un peu creusée et qu'elle rentre moins en contact lors des rebonds. Et une peinture réfléchissante nous apparut comme une bonne solution car elle peut être appliquée finement sur un contour non droit et adhère relativement bien. De plus les peintures d'isolement utilisées dans le bâtiment sont des des peintures réfléchissantes d'infrarouges.\\
Le problème a encore eu lieu au niveau des caméras : au début nous avons regardé le choix en caméra à infrarouges à haute vitesse. Et le choix était assez limité, en général avec des résolution dérisoires proches du VGA, ce qui était trop peu pour notre traitement. Puis nous nous sommes dit qu'il suffirait de prendre une caméra haute vitesse classique et d'appliquer un filtre infrarouge physique devant son objectif (moins de 100€ pour un bon filtre) et donc que cette caméra ne capterait qu'un peu de rouge au niveau des pixels excités par le rayonnement infrarouge. Le problème est que nombre de caméra ont un niveau de sensibilité réduit au domaine du visible voir à un niveau légèrement plus restreint comme on peut le voir sur le graphe du spectre de réponse de la M3. Les infrarouges qui passerait le filtre n'exciterait donc pas les capteur de la caméra et on obtiendrait alors un image tout simplement noire.\\
Il est à noter qu'un éclairage infrarouge aurait put aussi constituer une gêne pour le joueur, car ce rayonnement l'aurait chauffé comme le fait un radiateur, et que pendant un effort intense, cela peut être très inconfortable.

% INSERER GRAPHE REPONSE SPECTRALE M3

\subsection{Caméra normale}

Ce n'est pas parce que nous avons abandonné l'idée d'une caméra ultra-rapide que nous avons abandonné par la même occasion l'idée d'une caméra. Comme nous l'avons vu précedemment avec la vitesse de notre algorithme, nous avons estimé que nous pourrions traiter sans problème un flux de 60fps. Il est clair qu'à 60 fps, même avec un temps d'exposition réglable, qu'entre 2 images, un marqueur sur la balle aura largement tourné autour de la balle à la vitesse maximum de 100 tours par seconde. L'astuce consiste donc à se dire qu'avec un "long" temps d'exposition, on a des flous, plus précisémment des trainées, et elles peuvent s'avérer très utiles pour connaitre la rotation de la balle. Imaginons que la balle tourne autour d'un axe qui est celui qui vertical dans le plan de la feuille. Imaginons maintenant que l'on met un marqueur facilement détectable en traitement de l'image. La balle va tourner en avancant, Donc pendant le temps d'exposition la balle aura avancé (vers la gauche par exemple) et le marqueur sera passé une ou plusieurs fois devant la caméra, laissant une ou plusieurs traces d'une certaine longueur (voir figure ci dessous).

%INSERER FIGURE EXPLICATIVE

En connaissant la vitesse de la balle et la vitesse de la caméra, on peut en déduire la vitesse de rotation de la balle grâce aux nombre de trainées et à leur longueur. Seulement on a imaginé ici le cas avec une seule composante. En imaginant que la rotation ait aussi une composante selon l'axe de la largueur de la feuille on imagine que les trainées ressembleront à des virgules et que le calcul des vitesses de rotations se complexifie largement. Ajoutons maintenant 2 composantes à notre vitesse de translation, et une troisième composante à la rotation, ce qui représente la réalité. Eh bien on se retrouve avec quelque chose d'indigeste et nous n'avons rien put conclure de ces trainé en multidimensionnel ... Nous avons imaginé mettre des marqueurs parfois exotiques pour avoir des trainées distinctes selon les axes en jeu, mais rien de concluant n'est ressorti de cette étude, et nous avons donc définitivement abandonné l'idée de capter cette information de rotation directement par une(des) caméra(s).

Nous avions aussi imaginé la solution infrarouge avec une caméra normale pour obtenir notre trainée, mais les problèmes intrinsèques à ces trainées restaient toujours présent et nous n'avons donc pas put conclure sur quelque chose de satisfaisant.


\subsection{Balle intelligente}

Maintenant que notre option caméra était bel et bien enterrée, il nous fallait trouver une autre technologie pour acquérir ces données. Malgré le principe que nous nous étions fixé au départ de ne pas imposer trop de contraintes au joueur (balle spéciale, etc), nous ne voyions pas comment calculer cette vitesse sans données optique en sachant que la balle se déplace "aléatoirement" dans un volume relativement grand. Une solution assez naïve mais pas idiote est de placer le capteur, un gyromètre, directement dans la balle, avec une source d'énergie type pile, un controlleur de base et un module de communication sans fil type bluetooth (moins gourmand et les besoins en débit sont plus que limité : 3 doubles de temps en temps). Ainsi le mur peut interroger régulièrement la système de la balle (4 à 10 fois par seconde par exemple), en prenant en compte que plus on l'interroge, plus la pile se videra vite. On a donc une donnée sur la rotation relativement fiable accessible facilement sans calcul. Evidemment ce système a des inconvénient non négligeables : la balle coûtera sensiblement plus cher qu'une balle classique et ne se trouvera pas dans le décathlon du coin, alors qu'une balle vieillit relativement vite au tennis. Par ailleurs la source d'énergie pourra être amené à s'épuiser plus vite que ne l'est la durée de vie de la balle. Nous avons donc pensé au récent système de recharge sans fil qui pourrait remédier à ce problème. Nous n'avons cependant pas de donnée sur la consommation d'un tel système embarqué pour faire une estimmation de la durée de vie de la pile. Par ailleurs il pourrait être utile de pouvoir éteindre le système, car un module comme le bluetooth, même sans envoyer de données, est relativement énergivore, ce qui pourrait poser problème. Mais nous n'avons pas trouvé d'idée cohérente face à ce problème en prenant en compte que le système est isolé par un couche hermétique. \\
Par ailleurs avec un tel système dans la balle on peut imaginer que son équilibrage peut être altéré de façon plus ou moins importante selon le poids du module embarqué, et que ce déséquilibrage peut entrainer une gène pour le joueur de tennis ainsi qu'une modification du comportement de la balle qui a été étudié dans la partie mathématiques. Enfin il faut trouver un système relativement résistant, pour subir des forces centrifuges extrèmes ainsi que des accélérations hors du commun (quelques centaines de g).

\subsection{Raquette intelligente}

Par hasard en cherchant des solutions sur internet, nous sommes tombés sur un produit intéressant sur le site de Babolat, un fournisseur de matériel de tennis. C'était leur raquette Play and Connect. Cette raquette est bardée de capteur et d'un micro ordinateur dans son manche. Ainsi elle est capable d'analyser nombre d'information sur chaque coup joué par le joueur comme le montre cette page web : https://www.babolatplay.com/features \\
De plus la raquette est équipée d'un module bluetooth qui permet de diffuser ces informations en temps réel, initialement prévu pour envoyer ces données à un smartphone possédant l'application dédiée, mais il est concevable de détourner cette fonction pour récupérer ces données sur le PC du mur. Au niveau des contraintes, comme on peut s'y attendre, le prix de la raquette est deux fois plus élevé qu'une raquette de même qualité sans électronique embarqué et devrait avoisiner les 500€. Une autre contrainte est celle de l'autonomie de la raquette, celle ci étant de 6h selon le constructeur, elle apparait comme très correct pour un entrainement de tennis, même de longue durée.\\
Cependant le système actuel ne serait pas capable de fournir la vitesse de rotation de la balle. Mais il serait peut-être possible de l'obtenir mathématiquement grâce aux informations de puissance, de spin, etc mais nous n'avons pas eu le temps d'étudier ce modèle. Il est à noter qu'une prochaine version de cette Babolat Play and Connect pourrait fournir ces informations et donc être une solution de choix pour ce mur de tennis intelligent.













\section{Conclusion}






















\chapter{Détection du joueur}

On s'intéresse dans cette partie à la détection du joueur, pour pouvoir décider de la position de la balle que l'on renvoie avec le mur en fonction du style de jeu qui aura été décidé par le joueur lui-même. On s'intéressera donc aussi bien à la position du joueur mais aussi à son déplacement, pour pouvoir déterminer son intention (pour pouvoir prendre le joueur à contre-pied par exemple), mais aussi l'effort fourni depuis le début de l'entraînement (nombre de calories brûlées, distance parcourue et autres statistiques du genre). \\

Cette partie est bien moins complexe que la précédente étant donné les vitesses de déplacement bien moindre, des contraintes temporelles moins fortes et aussi une précision requise bien inférieure.


\section{Balayage laser}

\section{Caméra}










\chapter{Déplacement du mur}




\subsubsection{Utilisation d'une caméra ultra-rapide}

La première approche pour la détection de la balle est donc d'utiliser une caméra ultra-rapide qui puisse acquérir plus de 200 images par seconde. De telles caméras existent bien mais son relativement onéreuses : de 10 à 15 000 euros. Néanmoins, elles présentent des caractéristiques intéressantes (on présente ici les caractéristiques de la caméra M3 de idtVision).

\paragraph{Temps d'exposition réglable jusqu'à 1 micro-seconde\\}

On peut donc régler la temps d'exposition jusqu'à des valeurs qui permettent de supprimer tout flou sur notre balle. Le flou n'existe pas si la balle ne parcourt pas plus d'un pixel durant le temps d'exposition. Avec 1 micro-seconde, la balle a le temps de parcourir 0.028mm ce qui est de loin inférieur à ce que représente un pixel à une distance raisonable. Le problème qui apparait alors est la luminosité, puisque pour avoir une image exploitable, il est nécessaire que suffisament de lumière soit parvenue jusqu'au capteur durant le temps d'exposition, paramètre qui dépend bien sûr directement du temps d'exposition mais aussi de la sensibilité (mesurée en ISO) et de l'ouverture de l'objectif (sans unité). C'est là qu'interviennent deux autres caractéristiques de cette caméra. 

\paragraph{Sensibilité et monture C\\}

La sensibilité de cette caméra est de 1000 ISO en mode couleur et 3000 ISO en mode couleur, ce qui est assez élevé. La sensibilité représente la sensibilité du capteur à la lumière : ainsi, à quantité de lumière égale, une image prise à sensibilité 1000 ISO sera bien moins lumineuse qu'une image prise avec une sensibilité de 2000 ISO. 

Mais la luminosité dépend aussi d'un dernier paramètre qui est l'ouverture de l'objectif et c'est pour cela que la monture C de la caméra est importante. Les objectifs ayant une monture C (type d'attache entre la caméra et l'objectif) ont généralement des ouvertures très grandes ce qui permet donc d'avoir une très grande luminosité. \\


Une condition nécessaire pour l'utilisation de la caméra est de pouvoir l'utiliser en direct et donc de disposer d'un lien entre la caméra et la solution de calcul. La caméra citée précédemment convient donc tout à fait puisqu'elle dispose d'un lien Caméra Link, mais un lien Gigabit Ethernet aurait aussi pu faire l'affaire.

\paragraph{Limitations\\}

La principale limitation de l'utilisation de telles caméras (il existe de nombreuses caméras aux caractéristiques similaires à celles de la caméra M3 présentée précédemment) est la capacité à traiter les images en temps-réel. Un algorithme simple mais efficace pour la détection d'une balle est d'isoler la couleur de la balle (en utilisant le système de représentation des couleurs HSV plutôt que RGB), éliminer le bruit grâce à un processus de dilation et érosion et enfin de trouver les cercles de diamètre minimaux entourant les éléments restant. La trajectoire de la balle étant continue, on peut donc déterminer quel élément représente la balle et quels éléments représentent du bruit qui aurait résisté à l'étape d'élimination du bruit. Le temps d'éxécution est donc dépendant de la résolution des images obtenues, résolution qui doit cependant être suffisament élevée pour pouvoir détecter les rainures de la balle. 


\paragraph{Positionnement des caméras\\}

Caméra au plafond pas cool toussa, plutot sur bords du terrain du coup. Petits calculs pour montrer le truc et schéma si possible


\paragraph{Résultats\\}

Nous avons effectué quelques tests de détection de la balle, en faisant varier aussi bien la distance de la balle à la caméra, les conditions d'éclairages et les résolutions d'images, résultats suivants (temps d'éxécution)


\paragraph{Amélioration de la technique de détection\\}

L'étape de filtrage de l'image afin de ne garder que les éléments ayant la même couleur que la balle peut se simplifier grandement avec utilisation d'un peu de matériel peu onéreux et quelques propriétés optiques. Si les images captées par la caméra sont difficilement exploitables en l'état, c'est notamment car elles contiennent beaucoup trop d'informations, dont la plupart ne servent à rien dans notre cas. Une technique permettant d'obtenir des images beaucoup plus simples à exploiter serait donc de réaliser un filtrage avant le capteur, afin de ne garder que ce qui est intéressant sur l'image. \\

On pourrait alors utiliser un filtre ne laissant passer que la couleur de la balle de tennis mais cette solution est bien trop imprécise pour être utilisée (dépend fortement des conditions d'éclairage). L'idéal serait donc de pouvoir éclairer la balle d'une couleur bien précise et de filtrer cette couleur, mais cette solution risque fortement de pertuber le joueur. \\

On peut donc alors s'intéresser à la partie du spectre non visible, soit les infrarouges ou les ultra-violets. En effet les éléments reflètent bien moins dans ces parties du spectre que dans le spectre du visible, ce qui permet alors, dans le cas où on arrive à bien faire réfléchir notre élément d'intérêt (la balle) dans ces parties du spectre, d'isoler cet élément. Pour réaliser cela, on peut simplement enduire la balle de peinture qui reflète l'infrarouge, on aura alors un seul élément bien visible dans cette partie du spectre, s'il est suffisament éclairé. On peut pour palier à ça utiliser des lampes infrarouges qui éclaireront le terrain, sans gêner le joueur. Il ne suffit plus alors que d'utiliser un filtre ne laissant pas passer le spectre visible mais uniquement les infrarouges, ce qui se trouve assez facilement et est relativement peu couteux.


\subsubsection{Utilisation de caméra plus lente}

Marqueurs sur la balle, temps d'expo volontairement long .... 

